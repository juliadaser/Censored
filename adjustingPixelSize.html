<!DOCTYPE html>
<html>
  <body>
    <canvas id="canvas" width="640" height="480"></canvas>
    <input type="range" id="pixelSize" min="1" max="40" value="10" />

    <script>
      const video = document.createElement("video");
      video.autoplay = true;
      video.playsInline = true;

      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");
      const pixelSizeSlider = document.getElementById("pixelSize");

      navigator.mediaDevices
        .getUserMedia({ video: true })
        .then((stream) => {
          video.srcObject = stream;
        })
        .catch((err) => {
          console.error("Webcam error:", err);
        });

      function draw() {
        const pixelSize = parseInt(pixelSizeSlider.value);
        const w = Math.floor(canvas.width / pixelSize);
        const h = Math.floor(canvas.height / pixelSize);

        ctx.imageSmoothingEnabled = false;
        ctx.drawImage(video, 0, 0, w, h);
        ctx.drawImage(canvas, 0, 0, w, h, 0, 0, canvas.width, canvas.height);

        requestAnimationFrame(draw);
      }

      video.addEventListener("play", () => {
        requestAnimationFrame(draw);
      });
    </script>
  </body>
</html>
